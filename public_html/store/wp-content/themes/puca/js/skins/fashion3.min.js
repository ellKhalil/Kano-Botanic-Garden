"use strict";class StickyHeader{constructor(){var a=this;this.$tbayHeader=$("#tbay-header"),this.$tbayHeader.hasClass("main-sticky-header")&&this._initStickyHeader(),a._initHeaderCoverbg(),a._ClickRemoveHeaderCoverbg(),a._initSearchClick()}_initSearchClick(){$("#btn-search-click").on("click",function(){$(this).parent().toggleClass("active"),$("#tbay-header").toggleClass("nav-cover-active-1")})}_initHeaderCoverbg(){let a=$("#tbay-header #primary-menu > li");a.mouseenter(function(){$("#tbay-header").addClass("nav-cover-active-1")}).mouseleave(function(){$(this).closest(".dropdown-menu").length||$("#tbay-header").removeClass("nav-cover-active-1")}),$(".top-cart a > *").on("click",function(){$("#tbay-header").hasClass("nav-cover-active-1")&&$("#tbay-header").removeClass("nav-cover-active-1")})}_ClickRemoveHeaderCoverbg(){var a=$(window),b=$(".search-click");a.on("click.Bst",function(a){0<$(a.target).parents(".ui-autocomplete.ui-widget-content").length||0<$(a.target).parents("#primary-menu").length||0==b.has(a.target).length&&!b.is(a.target)&&($("#tbay-header").removeClass("nav-cover-active-1"),$("#btn-search-click").parent().removeClass("active"))})}_initStickyHeader(){var a=this,b=$(window).width(),c="undefined"==typeof $(".top-slider").height()?0:$(".top-slider").height(),d=this.$tbayHeader.height();this.$tbayHeader.hasClass("header-v9")&&(d+=c),$(window).scroll(function(){var e=0<$("#tbay-top-cart.tbay-top-cart.v1 .dropdown-content").height()?$("#tbay-top-cart.tbay-top-cart.v1").height():0;if(1024<=b)if($(this).scrollTop()>d+e+50){if(a.$tbayHeader.hasClass("sticky-header1"))return;a._stickyHeaderOnDesktop(!1,d,c)}else a.$tbayHeader.css("top",0).removeClass("sticky-header1").addClass("sticky-header2").next().css("margin-top",0);767>=b&&a._fixedHeaderOnMobile()})}_fixedHeaderOnMobile(){if($("body").hasClass("post-type-archive-product")){var a=$(".archive-shop .tbay-filter + .products").offset().top-$(window).scrollTop();99>a?($(".archive-shop .tbay-filter").next().css("margin-top",$(".archive-shop .tbay-filter").height()+20),$(".archive-shop .tbay-filter").addClass("fixed").css("top",36+$("#wpadminbar").outerHeight())):$(".archive-shop .tbay-filter").css("top",0).removeClass("fixed").next().css("margin-top",0)}}_stickyHeaderOnDesktop(a,b,c){this.$tbayHeader.addClass("sticky-header1").css("top",$("#wpadminbar").outerHeight()).removeClass("sticky-header2"),$("#tbay-top-cart").slideUp(500),this.$tbayHeader.next().css("margin-top",b-c);a||$("#tbay-header.sticky-header1 .tbay-topcart a.mini-cart.v1").on("click",function(){a=!0,$("html, body").scrollTop(0)})}}class AutoComplete{constructor(){if("undefined"!=typeof puca_settings){var a=this;a._callAjaxSearch(),$(document.body).on("search_device_mobile",()=>{a._callAjaxSearch()})}}_callAjaxSearch(){var a=this,b=jQuery("input[name=s]"),c=0;if(puca_settings.keep_header){let a=$("#tbay-header > div");a.each(function(){c+=$(this).outerHeight()}),0<$("#wpadminbar").length&&(c+=$("#wpadminbar").outerHeight())}b.on("focus",function(){var b=$(this);if($(this).parents(".tbay-search-form").hasClass("tbay-search-ajax")){var d="undefined"==typeof b.parents("form").data("appendto")?"":b.parents("form").data("appendto");$(this).autocomplete({source:function(a,c){jQuery.ajax({url:puca_settings.ajaxurl+"?callback=?&action=puca_autocomplete_search",dataType:"json",data:{term:a.term,category:this.element.parent().find(".dropdown_product_cat").val(),style:this.element.data("style"),post_type:this.element.parent().find(".post_type").val()},success:function(a){!a.length&&1<b.val().length&&(0<b.parents("form").find(d).find("ul").length?b.parents("form").find(d).find("ul li").remove():$(".ui-autocomplete."+b.data("style")).find("li").remove()),c(a)}})},position:{my:"left+0 top+0"},minLength:2,appendTo:d,autoFocus:!0,search:function(a){jQuery(a.currentTarget).parents(".tbay-search-form").addClass("load")},select:function(a,b){window.location.href=b.item.link},create:function(){jQuery(this).data("ui-autocomplete")._renderItem=function(a,b){var c="";if(a.addClass("ui-autocomplete-search"),a.addClass(b.style),b.image&&0<b.image.length)var c="<a href=\""+b.link+"\" title=\""+b.label+"\"><img src=\""+b.image+"\" ></a>";c+="<div class=\"group\">",c+="<div class=\"name\"><a href=\""+b.link+"\" title=\""+b.label+"\">"+b.label+"</a></div>",b.sku&&0<b.sku.length&&(c+="<div class=\"product-sku\">"+b.sku+"</div>"),b.price&&0<b.price.length&&(c+="<div class=\"price\">"+b.price+"</div>"),c+="</div>";var d=jQuery("<li>").append(c).appendTo(a);return d},jQuery(this).data("ui-autocomplete")._renderMenu=function(a,c){var d=this;jQuery.each(c,function(b,c){d._renderItemData(a,c)}),"undefined"!=typeof b.data("style")&&"style1"==b.data("style")?c[0].view_all?a.append("<li class=\"list-header ui-menu-divider\">"+c[0].result+"<a id=\"search-view-all\" data-id=\"#"+this.element.parents("form").attr("id")+"\" href=\"javascript:void(0)\">"+puca_settings.view_all+"</a></li>"):a.append("<li class=\"list-header ui-menu-divider\">"+c[0].result+"</li>"):c[0].view_all?(a.append("<li class=\"list-header ui-menu-divider\">"+c[0].result+"</li>"),a.append("<li class=\"list-bottom ui-menu-divider\"><a id=\"search-view-all\" data-id=\"#"+this.element.parents("form").attr("id")+"\" href=\"javascript:void(0)\">"+puca_settings.view_all+"</a></li>")):a.append("<li class=\"list-header ui-menu-divider\">"+c[0].result+"</li>"),$(document.body).trigger("puca_search_view_all")}},response:(b,c)=>{a._autoCompeleteResponse(c.content.length)},open:e=>{a._autoCompeleteOpen(e,b,d,c)},close:b=>{a._autoCompeleteClose(b)}}).focus(function(){1<b.val().length&&(b.parents(".tbay-search-form").addClass("active"),0<b.parents("form").find(d).find("ul").length?b.parents("form").find(d).find("ul").show():($(".ui-autocomplete."+b.data("style")).show(),puca_settings.keep_header&&$(".ui-autocomplete."+b.data("style")).addClass("tbay-ui-focus").css("top",c)),b.trigger(jQuery.Event("keydown")))})}}),$(".tbay-search-close").on("click",b=>{a._onClickTbayClose(b)}),$(document.body).on("puca_search_view_all",()=>{$("#search-view-all").on("click",function(){$($(this).data("id")).submit()})})}_onClickTbayClose(a){jQuery(a.currentTarget).parents(".tbay-search-form").find("input[name=s]").val(""),jQuery(a.currentTarget).parents(".tbay-search-form").removeClass("active"),jQuery(a.currentTarget).parents(".tbay-search-form").find(".tbay-preloader").hasClass("no-results")&&jQuery(a.currentTarget).parents(".tbay-search-form").find(".tbay-preloader").removeClass("no-results").empty(),jQuery(a.currentTarget).parents(".tbay-search-form").find("input[name=s]").autocomplete("destroy")}_autoCompeleteResponse(a){let b=jQuery(".tbay-preloader");0===a?(b.text(puca_settings.no_results),b.addClass("no-results"),b.parents(".tbay-search-form").removeClass("load"),b.parents(".tbay-search-form").addClass("active")):(b.empty(),b.removeClass("no-results"))}_autoCompeleteOpen(a,b,c,d){$(a.target).parents(".tbay-search-form").removeClass("load"),$(a.target).parents(".tbay-search-form").addClass("active");let e=$(a.target).parents("form").outerWidth(),f=$(a.target).parents("form").offset().left;$(a.target).autocomplete("widget").css({width:e,left:f}),0===b.parents("form").find(c).find("ul").length&&puca_settings.keep_header&&$(".ui-autocomplete."+b.data("style")).addClass("tbay-ui-focus").css("top",d)}_autoCompeleteClose(a){jQuery(a.target).parents(".tbay-search-form").removeClass("load")}}jQuery(document).ready(()=>{new StickyHeader,new AutoComplete});
